{% extends 'base.html' %}
{% import "_macros.html" as macros%}

{% block content %}
{{super()}}
<ul class="nav nav-tabs mt-5" id="myTab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="home-tab" data-toggle="tab" href="{{url_for('user.write_post')}}" role="tab" aria-controls="home" aria-selected="true">撰写博客</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="profile-tab" data-toggle="tab" href="{{url_for('user.manage_post',username=current_user.username)}}" role="tab" aria-controls="profile" aria-selected="false">管理博客</a>
  </li>
</ul>
<div class="tab-content mt-5" id="myTabContent">
  <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
    {% if form %}
      <form method="post" action>
          {{form.hidden_tag()}}
          <div class="form-group">
              {{form.title.label()}}
              {{form.title(class='form-control')}}
          </div>
          <div class="form-group">
              {{form.body.label()}}
              {{form.body(class='form-control')}}
          </div>
          {{form.submit(class='btn btn-primary')}}
      </form>
      {% endif %}
  </div>
   <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">

      <table class="table table-hover ">
          <thead>
            <tr>
                <th scope="col">id</th>
                <th scope="col">title</th>
                <th scope="col">read</th>
                <th scope="col">comments</th>
                <th scope="col">del</th>
                <th scope="col">edit</th>
                <th scope="col">issue</th>
            </tr>
          </thead>
          {% if posts %}
          <tbody>
            {% for post in posts%}
            <tr>
                <th scope="row">{{post.id}}</th>
                <td>{{post.title}}</td>
                <td>{{post.read}}</td>
                <td>{{post.comments.count()}}</td>
                <td><a class="btn btn-danger btn-sm" href="{{url_for('user.del_post',id=post.id)}}"><i class="fas fa-trash"></i>删除</a></td>
                <td><a class="btn btn-warning btn-sm" href="{{url_for('user.del_post',id=post.id)}}"><i class="fas fa-feather-alt"></i>编辑</a></td>
                <td><a class="btn btn-primary btn-sm" href="{{url_for('user.del_post',id=post.id)}}"><i class="fas fa-paper-plane"></i>发布</a></td>
            </tr>
            {% endfor %}
          </tbody>
          {% endif %}
      </table>
      {% if pagination %}
        <nav class="mt-5" aria-label="Page navigation">
        {{ macros.pagination_widget(pagination,'user.manage_post') }}
        </nav>
        {% endif %}
  </div>
</div>
{% endblock %}
 {% block jsfile %}
    {{ super() }}
    {{pagedown.include_pagedown()}}
 {% endblock %}